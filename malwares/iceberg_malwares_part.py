from iceberglist import *

testurl = 'http://story.malwares.com/135?category=592060'
		   
testurl = 'http://story.malwares.com/84?category=592060'
baseurl = 'http://story.malwares.com'

def malwares_crwrscript(url):
	html = requesturl(url).read().decode()
	soup = BeautifulSoup(html,'html.parser')
	onesoup = soup.select('#tt-body-page > div.jb-page.jb-youtube-auto > div.jb-background.jb-background-main > div > div > div.jb-column.jb-column-content > div.jb-cell.jb-cell-content.jb-cell-content-article > article')[0]
	title = (onesoup.select('div.jb-content-title.jb-content-title-article > h2 > a')[0].text)
	date = (onesoup.select('div.jb-article-information > ul > li > span')[-1].text.split()[0])
	date_split = date.split('.')
	filter_date = date_split[1]+'.'+date_split[2]+'.'+date_split[0]
	rawhtml = soup.select('section > div > div > div')[0] # .get_text('\n').strip())
	testdict ={}
	testdict.update(returnimg(rawhtml,testurl,baseurl))
	taglist = [x.text for x in soup.select('div.jb-sidebar-content.jb-sidebar-content-tags > ul > li')]
	testdict['tag'] = taglist
	testdict['date'] = filter_date
	testdict['title'] = title
	testdict['text'] = BeautifulSoup(testdict['html'],'html.parser').get_text('\n').strip()
	# if(dupcheck(collection,url,testdict['text'])):
		
	# 	return None
	return testdict

if __name__ == '__main__':
	malwares_crwrscript(testurl)




#tt-body-page > div.jb-page.jb-youtube-auto > div.jb-background.jb-background-main > div > div > div.jb-column.jb-column-content > div.jb-cell.jb-cell-content.jb-cell-content-article > article > header > div > h2